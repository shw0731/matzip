<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="reservReg">
<typeAlias alias="reservationReg" type="reservationRegVO"/>
<!-- 리절트 맵 -->

<resultMap id="reservationRes" class="reservationReg">
  <result property="memberID" column="memberID"/>
  <result property="RestaurantNo" column="RestaurantNo"/>
  <result property="reservationName" column="reservationName"/>
  <result property="reservationPhone" column="reservationPhone"/>
  <result property="visitors" column="visitors"/>
  <result property="reservation_date" column="reservation_date"/>
  <result property="reservation_time" column="reservation_time"/>
  <result property="reg_date" column="reg_date"/>
  <result property="reservation_state" column="reservation_state"/>
</resultMap>

	 <!-- 공통으로 사용할 select 절 정의 -->
	<sql id="select-all">
		SELECT * FROM reservationReg
	</sql>

	<!-- 공통으로 사용할 where-no 절 정의 -->
	<sql id="where-no">
		WHERE RestaurantNo = #RestaurantNo#
	</sql>

	<!-- select 쿼리문 정의 -->
	<!-- 예약 리스트 꺼내올때 -->
	<select id="select-All" resultMap="reservation_state" parameterClass="String">
		<include refid="select-all" />
		 ORDER BY RestaurantNo desc
	</select>
	
	<!-- 예약 상세보기할 때 -->
	<select id="selectAll" resultMap="reservation_state" parameterClass="String">
		select * from reservation where RestaurantNo = #RestaurantNo# 
	</select>

	<!-- 예약등록 -->
	<insert id="reservationInsert"  parameterClass="reservation">
	insert into reservation (
	memberID, RestaurantNo, reservationName, reservationPhone, visitors, reservation_date,
	reservation_time, reg_date, reservation_state
	) values(
	RESERVATION_RES_NO_SEQ.nextval, #memberID#, #RestaurantNo#, #reservationName#, #reservationPhone#, #visitors#, #reservation_date#, #reservation_time#
	,#reg_date#, #reservation_state#
	)
	</insert>
	
	<!-- 예약 수정 -->
	<update id="reservationUpdate" parameterClass="reservation">
		update reservation set 
			reservation_date=#reservation_date#, reservation_time=#reservation_time#
		where RestaurantNo=#RestaurantNo#
	</update>
	
	<!-- 예약 삭제 -->
  	<delete id="reservationDelete" parameterClass="reservation">
  	delete from reservationReg
  	<include refid="where-no" />
  	</delete>
  	</sqlMap>	