<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="powerLink">
<typeAlias alias="powerLink" type="powerLinkVO"/>
<!-- 리절트 맵 -->

<resultMap id="powerLinkRegRes" class="powerLinkReg">
 <result property="restaurantNo" column="restaurantNo"/>
 <result property="state" column="state"/>
 <result property="start_date" column="start_date"/>
 <result property="memberID" column="memberID"/>
</resultMap>

<!-- 공통으로 사용할 select절 정의 -->
<sql id="select-all">
  SELECT * FROM POWERLINKBOARD
</sql>

<!-- 공통으로 사용할 where-no절  -->
<sql id="where-no">
  WHERE restaurantNo = #restaurantNo#
</sql>

<!-- select쿼리문 정의 -->
<select id="selectAll" resultMap="powerLinkRegRes">
  <include refid="select-all"/>
  ORDER BY restaurantNo DESC
</select>

<select id="selectOne" resultMap="powerLinkRegRes" parameterClass="int">
  <include refid="select-all"/>
  <include refid="where-no"/>
</select>

<select id="selectLastNo" resultClass="powerLinkRegRes">
  SELECT max(restaurantNo) as restaurantNo FROM POWERLINKBOARD
</select>

<!-- insert쿼리문 정의 -->
<insert id="insertBoard" parameterClass="powerLinkRegRes">
  INSERT INTO POWERLINKBOARD(restaurantNo, state, start_date, memberID)
  VALUE (POWERLINKREG_NO_SQL.NEXTVAL, #subject#, #name#, #password#, #content#, #regdate#)
</insert>

<!-- update쿼리문 정의 -->
<update id="updateBoard" parameterClass="powerLinkRegRes">
  UPDATE POWERLINKBOARD SET RESTAURANTNO = #restaurantNo#,
                            STATE = #state#,
                            START_DATE= #start_date#,
                            MEMBERID = #memberID#
<include refid="where-no"/>
</update>

<update id="updateFile" parameterClass="powerinkRegRes">
  UPDATE POWERLINKREG SET FILE_ORGNAME=#file_orgname#
  FILE_SAVNAME=#file_savname#
  <include refid="where-no"/>
</update>

<!-- delete쿼리문 -->
<delete id="deleteBoard" parameterClass="powerLinkRegRes">
  DELETE FROM POWERLINKBOARD
  <include refid="where-no"/>
</delete>

</sqlMap>